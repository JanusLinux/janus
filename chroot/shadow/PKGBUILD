pkgname=chroot-shadow
pkgver=4.6
pkgrel=1
arch=('x86_64' 'x86' 'arm64' 'armv7l' 'armv5tel' 'ppc64le' 'ppc64' 'ppc')
source=("https://github.com/shadow-maint/shadow/releases/download/$pkgver/shadow-$pkgver.tar.xz")

build() {
	cd "$srcdir"/shadow-$pkgver
	./configure \
		--prefix=/tools \
		--bindir=/tools/bin \
		--sbindir=/tools/bin \
		--libdir=/tools/lib \
		--mandir=/tools/share/man \
		--sysconfdir=/tools/etc \
		--without-audit \
		--without-libcrack \
		--without-libpam \
		--without-nscd \
		--without-selinux \
		--with-group-name-max-length=32 \
		--build=$XHOST \
		--host=$XTARGET
	make
}

package() {
	cd "$srcdir"/shadow-$pkgver
	make DESTDIR="$pkgdir" install

	mv "$pkgdir"/tools/sbin/* "$pkgdir"/tools/bin
	rmdir "$pkgdir"/tools/sbin
}
