# Description: Python bindings for SELinux userland library
# URL:         https://github.com/SELinuxProject/selinux/wiki
# Maintainer:  protonesso, nagakamira at gmail dot com
# Depends on:  python swig libselinux
# Section:     python

name=python-libselinux
version=3.1
release=1
options=('bootstrap')
source=("https://github.com/SELinuxProject/selinux/releases/download/20200710/libselinux-$version.tar.gz")

build() {
	cd "$SRC"/libselinux-$version
	patch -Np1 -i "$STUFF"/libselinux/0001-add-internal-fts-implementation.patch
	patch -Np1 -i "$STUFF"/libselinux/0002-fix-gnuisms.patch

	make CFLAGS="$CFLAGS" LDFLAGS="-fPIC -pthread" all
	make CFLAGS="$CFLAGS" LDFLAGS="-fPIC -pthread" swigify
	make CFLAGS="$CFLAGS" LDFLAGS="-fPIC -pthread" PYTHON=python3 pywrap
	make CFLAGS="$CFLAGS" LDFLAGS="-fPIC -pthread" PYTHON=python3 \
		DESTDIR="$PKG" SBINDIR=/usr/bin SHLIBDIR=/usr/lib install-pywrap
}
