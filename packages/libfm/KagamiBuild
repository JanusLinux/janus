# Description: Library for file management
# URL:         https://lxde.org/
# Maintainer:  protonesso, nagakamira at gmail dot com
# Depends on:  intltool libexif gtk3 menu-cache
# Section:     lxde

name=libfm
version=1.3.2
release=1
source=("https://downloads.sourceforge.net/pcmanfm/$name-$version.tar.xz")

build() {
	cd "$SRC"/$name-$version
	./configure $BUILDFLAGS \
		--prefix=/usr \
		--sysconfdir=/etc \
		--with-gtk=3 \
		--disable-gtk-doc

	sed -i 's/ -shared / -Wl,--as-needed\0/g' libtool
	make
	make DESTDIR="$SRC/fakeinstall" install

	mkdir -p "$PKG"/usr/{lib/{libfm/modules,pkgconfig},share}
	pushd "$PKG"
		mv usr/bin "$PKG/usr"
		mv usr/lib/libfm-gtk3.so* "$PKG"/usr/lib
		mv usr/lib/libfm/modules/gtk-* "$PKG"/usr/lib/libfm/modules
		mv usr/lib/pkgconfig/libfm-gtk3.pc "$PKG/usr/lib/pkgconfig"
		mv usr/share/applications "$PKG/usr/share"
		mv usr/share/man "$PKG/usr/share"
	popd
}
