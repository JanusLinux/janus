# Description: Skinny libtool implementation, written in C
# URL:         http://git.midipix.org/cgit.cgi/slibtool
# Maintainer:  nee-san, nagakamira at gmail dot com

name=slibtool
version=0.5.28
release=1
source=("http://midipix.org/dl/$name/$name-$version.tar.xz")
BOOTSTRAP=yes

build() {
	unset CROSS_COMPILE CXX CPP AR AS RANLIB LD STRIP

	mkdir -p "$PKG"/usr/share/libtoolize/{AC_CONFIG_AUX_DIR,AC_CONFIG_MACRO_DIRS}
	mkdir -p "$PKG"/usr/bin
	install -m755 "$STUFF"/slibtool/ltmain.sh "$PKG"/usr/share/libtoolize/AC_CONFIG_AUX_DIR
	install -m755 "$STUFF"/slibtool/libtoolize "$PKG"/usr/bin

	cd "$SRC"/$name-$version

	CFLAGS_CMDLINE="$CFLAGS" NATIVE_CC="${NATIVE_CC:-gcc}" CC="${CC:-gcc}" \
	USER_CC="gcc" USER_CXX="g++" USER_CPP="cpp" \
	./configure \
		--prefix=/usr \
		--enable-shared
	make
	make DESTDIR="$PKG" install

	ln -sf slibtool "$PKG"/usr/bin/libtool
}
