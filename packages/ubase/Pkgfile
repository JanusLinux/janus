# Description: A suckless variant of the *nix core utilities
# URL:         https://core.suckless.org/ubase/
# Maintainer:  nee-san, nagakamira at gmail dot com

name=ubase
version=140efda3a263b9e6d922633c418fa9846d35731d
release=1
source=("https://github.com/nee-san/ubase/archive/$version.tar.gz")
BOOTSTRAP=yes

build() {
	cd "$SRC"/$name-$version
	if [ "$CROSS" = "yes" ]; then
		make HOSTCC="$HOSTCC" CC="$CC" CFLAGS="$CFLAGS" LDFLAGS='-static'
		make HOSTCC="$HOSTCC" CC="$CC" CFLAGS="$CFLAGS" LDFLAGS='-static' PREFIX=/usr MANPREFIX='/usr/share/man' DESTDIR="$PKG" install
	else
		make CFLAGS="$CFLAGS" LDFLAGS='-static'
		make CFLAGS="$CFLAGS" LDFLAGS='-static' PREFIX=/usr MANPREFIX='/usr/share/man' DESTDIR="$PKG" install
	fi

	rm -rf "$PKG"/usr/bin/{blkdiscard,clear,ctrlaltdel,dmesg,eject,fallocate,free,fsfreeze,halt,hwclock,insmod,last,lastlog,login,lsmod,mesg,mkswap,mount,mountpoint,nologin,passwd,pidof,pivot_root,ps,pwdx,rmmod,su,swaplabel,swapoff,swapon,switch_root,sysctl,umount,unshare,uptime,watch}
}
