# Description: Linux kernel packet control tool
# URL:         http://www.netfilter.org/projects/iptables/index.html
# Maintainer:  protonesso, nagakamira at gmail dot com

name=iptables
version=1.6.2
release=1
source=(http://www.netfilter.org/projects/$name/files/$name-$version.tar.bz2
	iptables
	iptables-finish
	ip6tables
	ip6tables-finish)

build() {
	cd $name-$version
	rm include/linux/types.h
	./configure \
		--prefix=/usr \
		--sysconfdir=/etc \
		--sbindir=/usr/bin \
		--libexecdir=/usr/lib/iptables \
		--with-xtlibdir=/usr/lib/iptables \
		--enable-libipq \
		--disable-nftables \
		--build=$(cc -dumpmachine)
	make
	make DESTDIR=$PKG install

	install -D -m755 $SRC/iptables $PKG/etc/sv/iptables/run
	install -D -m755 $SRC/iptables-finish $PKG/etc/sv/iptables/finsh

	install -D -m755 $SRC/ip6tables $PKG/etc/sv/ip6tables/run
	install -D -m755 $SRC/ip6tables-finish $PKG/etc/sv/ip6tables/finsh

	clean-package $PKG
}
