# Description: A featureful, general-purpose sound server (libraries only)
# URL:         https://www.freedesktop.org/wiki/Software/PulseAudio/
# Maintainer:  protonesso, nagakamira at gmail dot com
# Depends on:  libsndfile alsa-lib dbus glib libcap speex libxtst libsm sbc bluez rtkit libltdl
# Section:     sound

name=libpulse
version=14.2
release=1
backup=('etc/pulse/daemon.conf'
	'etc/pulse/default.pa'
	'etc/pulse/system.pa')
source=("https://www.freedesktop.org/software/pulseaudio/releases/pulseaudio-$version.tar.xz")

build() {
	cd "$SRC"/pulseaudio-$version

	NOCONFIGURE=1 ./bootstrap.sh
	./configure $BUILDFLAGS \
		--prefix=/usr \
		--libexecdir=/usr/lib \
		--sysconfdir=/etc \
		--localstatedir=/var \
		--with-bash-completion-dir=/usr/share/bash-completion/completions \
		--with-pulsedsp-location=/usr/lib/pulseaudio \
		--with-systemduserunitdir=/usr/lib/systemd/user \
		--with-udev-rules-dir=/usr/lib/udev/rules.d \
		--with-caps \
		--enable-ipv6 \
		--enable-systemd-daemon \
		--enable-systemd-journal \
		--enable-systemd-login \
		--disable-manpages \
		--disable-rpath
	make
	make DESTDIR="$PKG" install-pkgconfigDATA install-cmakeDATA install-dist_vapiDATA install-exec

	pushd "$PKG"
		rm -rf usr/bin
		rm -rf usr/lib/pulse-${version}
	popd
}
