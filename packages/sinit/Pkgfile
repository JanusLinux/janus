# Description: Suckless init
# URL:         http://tools.suckless.org/sinit/
# Maintainer:  nee-san, nagakamira at gmail dot com

name=sinit
version=1.1
release=1
source=("https://github.com/henrysher/sinit/archive/v$version.tar.gz")
BOOTSTRAP=yes

build() {
	cd "$SRC"/$name-$version
	cp "$KEEP"/sinit/sinit.h config.h

	if [ "$CROSS" = "yes" ]; then
		make HOSTCC="$HOSTCC" CC="$CC" CFLAGS="$CFLAGS" LDFLAGS='-static'
		make HOSTCC="$HOSTCC" CC="$CC" CFLAGS="$CFLAGS" LDFLAGS='-static' PREFIX=/usr MANPREFIX='/usr/share/man' DESTDIR="$PKG" install
	else
		make CFLAGS="$CFLAGS" LDFLAGS='-static'
		make CFLAGS="$CFLAGS" LDFLAGS='-static' PREFIX=/usr MANPREFIX='/usr/share/man' DESTDIR="$PKG" install
	fi

	install -Dm755 "$KEEP"/sinit/rc.boot "$PKG"/usr/bin/rc.boot
	install -Dm755 "$KEEP"/sinit/rc.down "$PKG"/usr/bin/rc.down

	ln -sf sinit "$PKG"/usr/bin/init
}
