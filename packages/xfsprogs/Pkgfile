# Description: XFS filesystem utilities
# URL:         http://xfs.org/index.php/Main_Page
# Maintainer:  protonesso, nagakamira at gmail dot com
# Depends on:  readline util-linux

name=xfsprogs
version=4.20.0
release=1
source=("https://www.kernel.org/pub/linux/utils/fs/xfs/xfsprogs/$name-$version.tar.xz")
BOOTSTRAP=yes

build() {
	export DEBUG=-DNDEBUG
	export OPTIMIZER="$CFLAGS"

	cd "$SRC"/$name-$version
	patch -p0 -i "$STUFF"/xfsprogs/00-patch-for-mips.diff

	./configure $BUILDFLAGS \
		--prefix=/usr \
		--sbindir=/usr/bin \
		--enable-readline
	make

	unset MAKEFLAGS
	make -j1 install install-dev \
		SHELL=/bin/bash \
		DIST_ROOT="$PKG" \
		PKG_ROOT_SBIN_DIR="/usr/bin"

	chown -R root "$PKG"
	chgrp -R root "$PKG"

	mv "$PKG"/lib/libhandle.so* "$PKG"/usr/lib/
	rm -rf "$PKG"/lib
}
