# Description: Configuration tools for Linux networking
# URL:         http://net-tools.sourceforge.net/
# Maintainer:  protonesso, nagakamira at gmail dot com

name=net-tools
version=1.60_p20180626073013
release=1
source=(http://distfiles.gentoo.org/distfiles/net-tools-$version.tar.xz)

set_opt() {
	local opt=$1 ans
	shift
	ans=$("$@" && echo y || echo n)
	sed -i \
		-e "/^bool.* ${opt} /s:[yn]$:${ans}:" \
		config.in || exit 1
}

build() {
	cd $name-$version
	sed -i "s#/sbin#/bin#" Makefile
	sed -i "s#/usr##" man/Makefile
	set_opt I18N use nls
	set_opt HAVE_AFINET6 use ipv6
	set_opt HAVE_HWIB has_version
	set_opt HAVE_HWTR has_version
	set_opt HAVE_HWSTRIP has_version
	set_opt HAVE_ARP_TOOLS use arp
	set_opt HAVE_HOSTNAME_TOOLS use hostname
	set_opt HAVE_HOSTNAME_SYMLINKS use nis
	set_opt HAVE_PLIP_TOOLS use plipconfig
	set_opt HAVE_SERIAL_TOOLS use slattach
	yes "" | ./configure.sh config.in
	make
	make DESTDIR=$PKG/usr update

	rm -rf $PKG/usr/bin/{nis,yp}domainname
	rm -rf $PKG/usr/bin/{hostname,dnsdomainname,domainname,ifconfig}

	clean-package $PKG
}
