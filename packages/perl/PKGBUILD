# Maintainer: protonesso <nagakamira@gmail.com>

pkgname=perl
pkgver=5.28.1
pkgrel=1
pkgdesc="A highly capable, feature-rich programming language"
arch=('x86_64' 'x86' 'arm64' 'armv7l' 'armv5tel' 'mips64' 'mips' 'ppc64le' 'ppc64' 'ppc')
url="http://www.perl.org"
license=('Artistic GPL-2.0')
depends=('musl' 'gdbm' 'db')
source=("https://www.cpan.org/src/5.0/$pkgname-$pkgver.tar.xz")
md5sums=('fbb590c305f2f88578f448581b8cf9c4')

build() {
	cd "$srcdir"/$pkgname-$pkgver
	./Configure -des \
		-Dprefix='' \
		-Dvendorprefix='' \
		-Dprivlib=/share/perl5/core_perl \
		-Darchlib=/lib/perl5/${pkgver%.*}/core_perl \
		-Dsitelib=/share/perl5/site_perl \
		-Dsitearch=/lib/perl5/${pkgver%.*}/site_perl \
		-Dvendorlib=/share/perl5/vendor_perl \
		-Dvendorarch=/lib/perl5/${pkgver%.*}/vendor_perl \
		-Dscriptdir=/bin/core_perl \
		-Dsitescript=/bin/site_perl \
		-Dvendorscript=/bin/vendor_perl \
		-Dman1dir=/share/man/man1 \
		-Dman3dir=/share/man/man3 \
		-Dpager="/bin/less -isR" \
		-Dinc_version_list=none \
		-Dcf_by='januslinux' \
		-Dcccdlflags='-fPIC' \
		-Dcccdlflags='-fPIC' \
		-Dccdlflags='-rdynamic' \
		-Doptimize="$CFLAGS" \
		-Duseshrplib \
		-Dusethreads
	make libperl.so && make
}

package() {
	cd "$srcdir"/$pkgname-$pkgver
	make DESTDIR="$pkgdir" install
}
