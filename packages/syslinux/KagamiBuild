# Description: Collection of boot loaders
# URL:         http://www.syslinux.org/
# Maintainer:  protonesso, nagakamira at gmail dot com
# Depends on:  perl nasm mtools linux-headers
# Section:     base

name=syslinux
version=6.04+pre1
release=1
source=("https://mirrors.edge.kernel.org/pub/linux/utils/boot/syslinux/Testing/6.04/syslinux-${version/+/-}.tar.gz")

build() {
	cd "$SRC"/syslinux-${version/+/-}
	unset CFLAGS CXXFLAGS LDFLAGS

	patch -Np1 -i "$STUFF"/syslinux/syslinux-6.03-sysmacros.patch
	patch -Np1 -i "$STUFF"/syslinux/syslinux-6.04_pre1-fcommon.patch

	make installer
	make -j1 INSTALLROOT="$PKG" MANDIR=/usr/share/man bios install

	install -Dm0644 "$STUFF"/syslinux/syslinux.cfg $PKG/boot/syslinux/syslinux.cfg
}
