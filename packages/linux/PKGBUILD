# Maintainer: protonesso <nagakamira@gmail.com>

pkgname=linux
pkgver=4.14.39
pkgrel=1
arch=('x86_64' 'i686' 'aarch64' 'armv7l')
url="https://www.kernel.org/"
license=('GPL')
groups=('base')
source=("https://cdn.kernel.org/pub/linux/kernel/v4.x/$pkgname-$pkgver.tar.xz"
	'x86_64-config'
	'i386-config'
	'arm64-config'
	'arm-config')

build() {
	cd "$srcdir/$pkgname-$pkgver"
	cp $srcdir/$XKARCH-config .config
	make ARCH=$XKARCH CROSS_COMPILE=$XTARGET- silentoldconfig
	make ARCH=$XKARCH CROSS_COMPILE=$XTARGET-
}

package() {
	cd "$srcdir/$pkgname-$pkgver"
	make ARCH=$XKARCH CROSS_COMPILE=$XTARGET- INSTALL_MOD_PATH=$pkgdir/usr modules_install

	mkdir -p $pkgdir/boot
	case $XKARCH in
		x86_64|i386)
			cp arch/x86/boot/bzImage $pkgdir/boot/bzImage
			;;
		aarch64)
			cp arch/arm64/boot/zImage $pkgdir/boot/zImage
			;;
		arm)
			cp arch/arm/boot/zImage $pkgdir/boot/zImage
			;;
	esac
}
