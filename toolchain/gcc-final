name="gcc-7.3.0"
srcdir="$SOURCES/$name"
tarball="$name.tar.xz"

bld() {
	cd $SOURCES
	rm -rf $name
	tar -xf $tarball
	cd $name
	sed -i 's@\./fixinc\.sh@-c true@' gcc/Makefile.in
	tar -xf ../gmp-6.1.2.tar.xz
	mv gmp-6.1.2 gmp
	tar -xf ../mpfr-4.0.1.tar.xz
	mv mpfr-4.0.1 mpfr
	tar -xf ../mpc-1.1.0.tar.gz
	mv mpc-1.1.0 mpc
	mkdir build
	cd build
	AR="ar"\
	../configure \
		--prefix=$TOOLS \
		--build=$XHOST \
		--host=$XHOST \
		--target=$XTARGET \
		--with-sysroot=$ROOTFS \
		--with-local-prefix=$ROOTFS/usr \
		--with-native-system-header-dir=/usr/include \
		--enable-__cxa_atexit \
		--enable-checking=release \
		--enable-clocale=generic \
		--enable-languages=c,c++ \
		--enable-libstdcxx-time \
		--enable-linker-build-id \
		--enable-threads=posix \
		--disable-gnu-indirect-function \
		--disable-libmudflap \
		--disable-libmpx \
		--disable-libsanitizer \
		--disable-libssp \
		--disable-multilib \
		--disable-nls \
		--disable-symvers \
		$GCCOPTS
	make AS_FOR_TARGET="$XTARGET-as" LD_FOR_TARGET="$XTARGET-ld" $MKOPTS
	make install
}
